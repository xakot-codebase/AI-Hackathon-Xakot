<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Trace Viewer</title>
  <style>
    body { font-family: Inter, Arial, sans-serif; margin: 24px; }
    h1 { color: #0B2545; }
    input { padding: 8px; width: 360px; }
    .event { border: 1px solid #dbe1ea; border-radius: 8px; padding: 12px; margin: 10px 0; background: #f7f9fc; }
    .stage { font-weight: bold; color: #0B2545; }
    pre { white-space: pre-wrap; word-wrap: break-word; }
  </style>
</head>
<body>
  <h1>Trace Viewer</h1>
  <p>Enter TRACE_ID (e.g., <code>xakot-...</code>)</p>
  <input id="tid" placeholder="xakot-..."/>
  <button onclick="load()">Load</button>
  <div id="out"></div>

  <script>
    async function load(){
      const tid = document.getElementById('tid').value.trim();
      const out = document.getElementById('out');
      out.innerHTML = 'Loading...';
      const res = await fetch('/trace/' + encodeURIComponent(tid));
      const data = await res.json();
      out.innerHTML = '';
      if(!data.length){ out.innerHTML = '<p>No events found</p>'; return; }
      data.forEach(ev => {
        const div = document.createElement('div');
        div.className = 'event';
        const ts = new Date(ev.ts * 1000).toISOString();
        div.innerHTML = '<div class="stage">' + ev.stage + ' â€” ' + ts + '</div>' +
                        '<pre>' + JSON.stringify(ev, null, 2) + '</pre>';
        out.appendChild(div);
      });
    }
  </script>
</body>
</html>
